---
allowed-tools: Task, Read, Bash
---

# DD 任务完成

标记任务为已完成状态, 自动更新进度并同步功能状态.

## 使用方式

```bash
/dd:task-finish <功能名>:<任务ID>
```

## 执行流程

### 1. 任务状态更新

调用任务完成脚本:

```bash
bash .claude/scripts/dd/task-finish.sh "<feature>:<task_id>"
```

### 2. 自动化处理

脚本会自动执行:

- 更新任务状态为"已完成"
- 重新计算任务进度 (100%)
- 更新功能整体进度
- 执行 Git 状态检查
- 生成完成总结报告

## 核心功能

### 智能进度管理

- 基于 Todo 项完成度自动计算进度
- 级联更新功能进度
- 同步所有相关的进度数据

### Git 状态验证

- 检查工作区状态
- 验证分支一致性
- 提供 Git 操作建议

### 完成状态分析

- 检查功能整体完成情况
- 识别剩余未完成任务
- 提供下一步操作建议

## 输出信息

### 任务完成确认

```
=== TASK_COMPLETION ===
TASK_ID: 用户认证系统:001
FEATURE_NAME: 用户认证系统
TASK_NUMBER: 001
TASK_FILE: .claude/features/用户认证系统/tasks/001.md

✅ 任务状态已更新为: 已完成
```

### 进度更新报告

```
=== TASK_PROGRESS_UPDATE ===
🔄 计算并更新任务进度...
📊 任务进度已更新: 100%

=== FEATURE_PROGRESS_UPDATE ===
🔄 重新计算功能进度...
📊 功能进度已更新: 用户认证系统 (75%)
  总任务: 4, 已完成: 3
```

### Git 状态检查

- 未提交文件检查
- 远程仓库同步状态
- 分支状态验证
- 合并冲突检查

### 完成总结

```
=== TASK_COMPLETION_SUMMARY ===
📝 任务完成总结:
  任务: 用户认证系统:001
  名称: 实现用户注册功能
  进度: 100%
  状态: 已完成

🎯 功能整体进度: 75%
📋 剩余 1 个未完成任务
💡 建议下一步: 继续完成其他任务
```

## 使用示例

```bash
# 完成用户认证系统的第一个任务
/dd:task-finish 用户认证系统:001

# 完成支付模块的第三个任务
/dd:task-finish 支付模块:003
```

## 智能建议

任务完成后, 系统会根据当前状态提供智能建议:

- **所有任务完成**: 建议进行功能验收检查
- **还有剩余任务**: 建议继续完成其他任务
- **Git 状态异常**: 建议先处理 Git 问题
- **进度同步异常**: 建议运行进度同步

## 注意事项

- 任务完成后无法撤销, 请确认任务确实已完成
- 系统会自动更新所有相关的进度数据
- 建议在任务真正完成后再执行此命令
- Git 检查发现问题时建议先处理再继续

## 相关命令

- `/dd:task-start <功能名>:<任务ID>` - 开始任务
- `/dd:feature-start <功能名>` - 查看功能状态
- `/dd:status` - 查看项目整体进度
- `/dd:code-reflect` - 分析代码变更
