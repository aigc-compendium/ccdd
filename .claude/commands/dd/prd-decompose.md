---
allowed-tools: Task, Read, Write, Edit, Bash, Glob, Grep
---

# DD 需求拆解命令

基于 PRD 和架构设计, 将项目需求拆解为大功能模块, 为新项目规划完整的功能开发路径.

## 核心功能

### 1. 需求模块拆解

- 分析 PRD 文档中的用户需求
- 结合架构设计确定技术边界
- 拆解为独立的大功能模块
- 确保功能模块的内聚性和松耦合

### 2. 依赖关系分析

- 分析功能模块间的依赖关系
- 识别核心基础模块和业务模块
- 确定模块开发的先后顺序
- 避免循环依赖和复杂依赖

### 3. 开发优先级规划

- 基于业务价值和技术复杂度排序
- 考虑 MVP(最小可行产品)需求
- 规划迭代开发计划
- 平衡风险和收益

### 4. 功能规格预览

- 为每个功能模块生成概要描述
- 估算开发复杂度和工作量
- 识别技术风险和依赖
- 提供功能边界说明

## 执行流程

### 1. 上下文加载

```
读取 .claude/context/project.md
读取 .claude/context/architecture.md
读取 PRD 相关文档
分析技术选型和架构约束
```

### 2. 深度思考分析

使用 Task 工具调用 deep-thinker 智能体进行:

- 需求完整性分析
- 技术可行性评估
- 模块划分合理性判断
- 依赖关系复杂度评估

### 3. 功能模块设计

为每个识别的功能模块:

- 定义功能边界和职责
- 分析对外接口需求
- 评估技术实现复杂度
- 估算开发时间和资源

### 4. 开发路径规划

- 构建功能依赖图
- 制定开发里程碑
- 规划并行开发策略
- 识别关键路径和风险点

## 输出格式

生成 `.claude/context/requirements-breakdown.md` 文档:

```markdown
---
breakdown_date: 2024-01-15T10:30:00Z
total_modules: 8
estimated_weeks: 16
complexity: 中等
priority_order: [模块1, 模块2, ...]
---

# 项目需求拆解方案

## 功能模块概览

### 1. 模块名称

- **功能描述**: [模块核心功能和价值]
- **技术复杂度**: 简单|中等|复杂
- **优先级**: 高|中|低
- **预估工时**: X 周
- **依赖模块**: [前置依赖模块]
- **风险评估**: [技术风险和缓解措施]

## 开发路径规划

### 第一阶段 (核心基础)

- 模块 A: 用户认证系统
- 模块 B: 数据层设计

### 第二阶段 (核心业务)

- 模块 C: 业务逻辑核心
- 模块 D: API 接口层

### 第三阶段 (增强功能)

- 模块 E: 高级特性
- 模块 F: 性能优化

## 依赖关系图
```

[ASCII 依赖关系图或文字描述]

```

## MVP 功能范围
第一阶段完成后可交付的最小可行产品功能列表

## 风险分析
主要技术风险、资源风险和时间风险的识别和应对策略
```

## 完成后提示

命令执行完成后, 向用户提示:

```
🎯 需求拆解完成！
📋 已生成 {X} 个功能模块的开发规划
⏱️ 预估总开发时间: {Y} 周

📝 建议下一步操作:
   /dd:feature-add <第一优先级功能名>

💡 或查看完整拆解方案:
   查看 .claude/context/requirements-breakdown.md
```

## 深度思考要点

### 模块划分原则

- **单一职责**: 每个模块专注一个核心功能域
- **高内聚低耦合**: 模块内部紧密协作, 模块间接口清晰
- **可维护性**: 模块边界清晰, 便于独立开发和维护
- **可扩展性**: 预留未来功能扩展的接口和空间

### 技术债务考虑

- 识别可能的技术债务积累点
- 规划重构和优化的时间窗口
- 平衡快速交付和代码质量
- 考虑维护成本和团队能力

### 风险缓解策略

- 为高风险模块准备备选方案
- 建立原型验证关键技术假设
- 规划增量交付和用户反馈循环
- 预留缓冲时间处理不可预见问题

## 文档生成规范

### 文档格式要求

所有生成的文档内容必须遵循以下格式规范：

- **中英文混合文本**：英文单词与中文字符之间必须有一个空格
- **示例**：`这是一个 API 接口层` 而不是 `这是一个API接口层`
- **列表项格式**：多个功能模块必须分行显示，每行以 "- " 开头
- **正确示例**：
  ```
  - 用户认证系统
  - 数据管理模块
  - API 接口层
  ```
- **错误示例**：`用户认证系统|数据管理模块|API接口层`
- **适用范围**：所有功能模块描述、技术分析、开发计划等

## 使用场景

### 新项目启动

在完成 `dd:framework-init` 架构设计后, 使用此命令将整个项目需求拆解为可管理的功能模块, 建立清晰的开发路径.

### 大型功能规划

对于复杂的业务需求, 先进行需求拆解可以更好地理解问题域, 避免功能设计时遗漏关键环节.

### 团队协作规划

通过需求拆解可以更好地分配开发议题, 让团队成员理解整体架构和各自负责的模块边界.
