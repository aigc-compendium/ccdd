---
allowed-tools: Read, LS, Task
---

# æ”¹åŠ¨åŽè‡ªæˆ‘åæ€

åœ¨å®Œæˆä»£ç æ”¹åŠ¨æˆ–ä»»åŠ¡åŽï¼Œè¿›è¡Œæ·±åº¦åæ€åˆ†æžï¼Œè¯„ä¼°æ”¹åŠ¨çš„åˆç†æ€§ã€æž¶æž„ä¸€è‡´æ€§å’Œå¯¹åŽç»­å¼€å‘çš„å½±å“ã€‚

## ç”¨æ³•
```
/dd:reflect-on-changes [--è¯¦ç»†]
```

## å‚æ•°è¯´æ˜Ž
- `--è¯¦ç»†` - ç”Ÿæˆè¯¦ç»†çš„åæ€æŠ¥å‘Šï¼ˆå¯é€‰ï¼‰

## åŠŸèƒ½æ¦‚è¿°

è¿™ä¸ªå‘½ä»¤æä¾›å…¨é¢çš„æ”¹åŠ¨åŽåæ€åˆ†æžï¼Œå¸®åŠ©ï¼š
- éªŒè¯æ”¹åŠ¨æ˜¯å¦ç¬¦åˆé¢„æœŸ
- æ£€æŸ¥æž¶æž„ä¸€è‡´æ€§
- è¯„ä¼°å¯¹åŽç»­ä»»åŠ¡çš„å½±å“
- è¯†åˆ«æ½œåœ¨çš„æŠ€æœ¯å€ºåŠ¡

## æ“ä½œæŒ‡å—

### 1. æ”¹åŠ¨èŒƒå›´åˆ†æž

#### ä½¿ç”¨ä»£ç åˆ†æžæ™ºèƒ½ä½“è¿›è¡Œæ·±åº¦åˆ†æž
```yaml
Task:
  description: "æ·±åº¦åˆ†æžæ”¹åŠ¨å½±å“"
  subagent_type: "code-analyzer"
  prompt: |
    å¯¹æœ€è¿‘çš„ä»£ç æ”¹åŠ¨è¿›è¡Œå…¨é¢åæ€åˆ†æžï¼š
    
    åˆ†æžèŒƒå›´ï¼š
    1. æ”¹åŠ¨åˆç†æ€§è¯„ä¼°
       - æ”¹åŠ¨æ˜¯å¦è§£å†³äº†é¢„æœŸé—®é¢˜
       - å®žçŽ°æ–¹å¼æ˜¯å¦æœ€ä¼˜
       - æ˜¯å¦å¼•å…¥äº†ä¸å¿…è¦çš„å¤æ‚æ€§
    
    2. æž¶æž„ä¸€è‡´æ€§æ£€æŸ¥
       - æ˜¯å¦ç¬¦åˆçŽ°æœ‰æž¶æž„æ¨¡å¼
       - æ˜¯å¦ç ´åäº†ç³»ç»Ÿè¾¹ç•Œ
       - æ˜¯å¦è¿åäº†è®¾è®¡åŽŸåˆ™
    
    3. ä»£ç è´¨é‡è¯„ä¼°
       - ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§
       - é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
       - æ€§èƒ½å½±å“åˆ†æž
    
    4. é›†æˆå½±å“åˆ†æž
       - å¯¹å…¶ä»–ç»„ä»¶çš„å½±å“
       - æŽ¥å£å˜æ›´çš„å‘åŽå…¼å®¹æ€§
       - æ•°æ®æµå˜åŒ–çš„å½±å“
    
    5. åŽç»­å¼€å‘å½±å“
       - å¯¹è®¡åˆ’ä¸­ä»»åŠ¡çš„å½±å“
       - å¯èƒ½é˜»å¡žçš„å¼€å‘å·¥ä½œ
       - éœ€è¦è°ƒæ•´çš„ç›¸å…³ä»»åŠ¡
    
    è¯·æä¾›ï¼š
    - æ”¹åŠ¨è´¨é‡è¯„åˆ†ï¼ˆ1-10åˆ†ï¼‰
    - å…·ä½“çš„æ”¹è¿›å»ºè®®
    - æ½œåœ¨é£Žé™©è¯†åˆ«
    - åŽç»­è¡ŒåŠ¨å»ºè®®
    
    åˆ†æžè¦å®¢è§‚ã€å…·ä½“ï¼Œçªå‡ºå…³é”®é—®é¢˜å’Œå»ºè®®ã€‚
```

### 2. å½“å‰ä»»åŠ¡å¯¹é½æ£€æŸ¥

#### éªŒè¯ä»»åŠ¡å®Œæˆåº¦
```bash
# æ£€æŸ¥å½“å‰ä»»åŠ¡çŠ¶æ€
if [ -f ".claude/context/current-task.md" ]; then
  task_id=$(grep "^ä»»åŠ¡ID:" .claude/context/current-task.md | sed 's/^ä»»åŠ¡ID: *//')
  task_name=$(grep "^ä»»åŠ¡åç§°:" .claude/context/current-task.md | sed 's/^ä»»åŠ¡åç§°: *//')
  
  echo "ðŸŽ¯ å½“å‰ä»»åŠ¡ï¼š$task_name (ID: $task_id)"
  
  # è¯»å–ä»»åŠ¡çš„éªŒæ”¶æ ‡å‡†
  task_file=$(find .claude/epics -name "${task_id}.md" | head -1)
  if [ -f "$task_file" ]; then
    echo "ðŸ“‹ æ£€æŸ¥éªŒæ”¶æ ‡å‡†ç¬¦åˆåº¦..."
    acceptance_criteria=$(sed -n '/^## éªŒæ”¶æ ‡å‡†/,/^## /p' "$task_file" | grep "^- \[ \]")
    echo "$acceptance_criteria"
  fi
fi
```

#### å¯¹æ¯”é¢„æœŸvså®žé™…
```bash
# åˆ†æžå®žé™…æ”¹åŠ¨ä¸Žä»»åŠ¡é¢„æœŸçš„å·®å¼‚
analyze_expectation_vs_reality() {
  echo "ðŸ” åˆ†æžé¢„æœŸvså®žé™…å·®å¼‚..."
  
  if [ -f "$task_file" ]; then
    # æå–ä»»åŠ¡çš„æŠ€æœ¯æ–¹æ¡ˆ
    expected_approach=$(sed -n '/^### æŠ€æœ¯æ–¹æ¡ˆ/,/^### /p' "$task_file")
    
    # æå–å®žé™…çš„æ–‡ä»¶å˜æ›´
    actual_changes=$(git diff --name-status HEAD~1..HEAD 2>/dev/null)
    
    echo "ðŸ“ é¢„æœŸæ–¹æ¡ˆï¼š"
    echo "$expected_approach"
    echo ""
    echo "ðŸ“„ å®žé™…å˜æ›´ï¼š"
    echo "$actual_changes"
  fi
}
```

### 3. æž¶æž„ä¸€è‡´æ€§éªŒè¯

#### ä½¿ç”¨ä¸Šä¸‹æ–‡åˆ†æžæ™ºèƒ½ä½“
```yaml
Task:
  description: "éªŒè¯æž¶æž„ä¸€è‡´æ€§"
  subagent_type: "context-analyzer"
  prompt: |
    éªŒè¯æœ€è¿‘æ”¹åŠ¨çš„æž¶æž„ä¸€è‡´æ€§ï¼š
    
    é¡¹ç›®ä¸Šä¸‹æ–‡ï¼š
    {åŠ è½½ project-structure.md å’Œ system-patterns.md}
    
    æœ€è¿‘æ”¹åŠ¨ï¼š
    {æä¾› git diff ä¿¡æ¯}
    
    å½“å‰ä»»åŠ¡ï¼š
    {æä¾›å½“å‰ä»»åŠ¡ä¿¡æ¯}
    
    è¯·åˆ†æžï¼š
    1. æ”¹åŠ¨æ˜¯å¦ç¬¦åˆæ—¢å®šçš„æž¶æž„æ¨¡å¼
    2. æ˜¯å¦å¼•å…¥äº†æ–°çš„æž¶æž„å¤æ‚æ€§
    3. ç›®å½•ç»“æž„å’Œå‘½åæ˜¯å¦ä¸€è‡´
    4. æ˜¯å¦è¿åäº†åˆ†å±‚åŽŸåˆ™
    5. æ˜¯å¦éœ€è¦æ›´æ–°æž¶æž„æ–‡æ¡£
    
    æä¾›å…·ä½“çš„ä¸€è‡´æ€§è¯„ä¼°å’Œæ”¹è¿›å»ºè®®ã€‚
```

#### æ¨¡å¼éµå¾ªæ£€æŸ¥
```bash
# æ£€æŸ¥æ˜¯å¦éµå¾ªé¡¹ç›®æ¨¡å¼
check_pattern_compliance() {
  echo "ðŸ—ï¸ æ£€æŸ¥æž¶æž„æ¨¡å¼éµå¾ªæƒ…å†µ..."
  
  # ä»Žsystem-patterns.mdè¯»å–æ—¢å®šæ¨¡å¼
  if [ -f ".claude/context/system-patterns.md" ]; then
    echo "ðŸ“– æ—¢å®šæž¶æž„æ¨¡å¼ï¼š"
    grep "^- " .claude/context/system-patterns.md | head -5
    echo ""
    echo "ðŸ” è¯·ç¡®è®¤æ”¹åŠ¨æ˜¯å¦éµå¾ªä¸Šè¿°æ¨¡å¼..."
  fi
}
```

### 4. æŠ€æœ¯å€ºåŠ¡è¯„ä¼°

#### å€ºåŠ¡è¯†åˆ«
```bash
# è¯†åˆ«å¯èƒ½çš„æŠ€æœ¯å€ºåŠ¡
identify_technical_debt() {
  echo "ðŸ’³ æŠ€æœ¯å€ºåŠ¡è¯„ä¼°..."
  
  local debt_indicators=()
  
  # æ£€æŸ¥TODOæ³¨é‡Šï¼ˆè¿åç»å¯¹è§„åˆ™ï¼‰
  if git diff HEAD~1..HEAD | grep -i "TODO\|FIXME\|HACK"; then
    debt_indicators+=("å‘çŽ°TODO/FIXMEæ³¨é‡Š")
  fi
  
  # æ£€æŸ¥å¤åˆ¶ä»£ç 
  if git diff --name-only HEAD~1..HEAD | xargs -I {} sh -c 'echo "=== {} ===" && cat {}' | grep -A5 -B5 "function\|def\|const.*="; then
    echo "âš ï¸ æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä»£ç é‡å¤..."
  fi
  
  # æ£€æŸ¥é…ç½®ç¡¬ç¼–ç 
  if git diff HEAD~1..HEAD | grep -E "localhost|127.0.0.1|hardcoded"; then
    debt_indicators+=("å‘çŽ°ç¡¬ç¼–ç é…ç½®")
  fi
  
  if [ ${#debt_indicators[@]} -gt 0 ]; then
    echo "âš ï¸ è¯†åˆ«åˆ°çš„æŠ€æœ¯å€ºåŠ¡ï¼š"
    for debt in "${debt_indicators[@]}"; do
      echo "  - $debt"
    done
  else
    echo "âœ… æœªå‘çŽ°æ˜Žæ˜¾çš„æŠ€æœ¯å€ºåŠ¡"
  fi
}
```

### 5. æ€§èƒ½å½±å“åˆ†æž

#### æ€§èƒ½å…³æ³¨ç‚¹æ£€æŸ¥
```bash
# åˆ†æžæ€§èƒ½å½±å“
analyze_performance_impact() {
  echo "âš¡ æ€§èƒ½å½±å“åˆ†æž..."
  
  # æ£€æŸ¥æ•°æ®åº“æŸ¥è¯¢å˜æ›´
  if git diff HEAD~1..HEAD | grep -i "select\|insert\|update\|delete\|query"; then
    echo "ðŸ—„ï¸ å‘çŽ°æ•°æ®åº“ç›¸å…³å˜æ›´ï¼Œè¯·æ³¨æ„ï¼š"
    echo "  - æŸ¥è¯¢æ•ˆçŽ‡"
    echo "  - ç´¢å¼•éœ€æ±‚"
    echo "  - äº‹åŠ¡è¾¹ç•Œ"
  fi
  
  # æ£€æŸ¥å¾ªçŽ¯å’Œç®—æ³•
  if git diff HEAD~1..HEAD | grep -E "for.*in|while|forEach|map|filter|reduce"; then
    echo "ðŸ”„ å‘çŽ°å¾ªçŽ¯/è¿­ä»£å˜æ›´ï¼Œè¯·æ³¨æ„ï¼š"
    echo "  - æ—¶é—´å¤æ‚åº¦"
    echo "  - æ•°æ®é‡å½±å“"
    echo "  - å†…å­˜ä½¿ç”¨"
  fi
  
  # æ£€æŸ¥ç½‘ç»œè¯·æ±‚
  if git diff HEAD~1..HEAD | grep -i "fetch\|axios\|http\|api"; then
    echo "ðŸŒ å‘çŽ°ç½‘ç»œè¯·æ±‚å˜æ›´ï¼Œè¯·æ³¨æ„ï¼š"
    echo "  - è¯·æ±‚é¢‘çŽ‡"
    echo "  - é”™è¯¯å¤„ç†"
    echo "  - è¶…æ—¶è®¾ç½®"
  fi
}
```

### 6. åŽç»­ä»»åŠ¡å½±å“è¯„ä¼°

#### ä¾èµ–ä»»åŠ¡åˆ†æž
```bash
# åˆ†æžå¯¹å…¶ä»–ä»»åŠ¡çš„å½±å“
analyze_task_dependencies() {
  echo "ðŸ“Š åˆ†æžå¯¹åŽç»­ä»»åŠ¡çš„å½±å“..."
  
  if [ -f ".claude/context/current-task.md" ]; then
    current_task_id=$(grep "^ä»»åŠ¡ID:" .claude/context/current-task.md | sed 's/^ä»»åŠ¡ID: *//')
    
    # æŸ¥æ‰¾ä¾èµ–å½“å‰ä»»åŠ¡çš„å…¶ä»–ä»»åŠ¡
    dependent_tasks=$(find .claude/epics -name "*.md" -exec grep -l "ä¾èµ–:.*$current_task_id" {} \;)
    
    if [ -n "$dependent_tasks" ]; then
      echo "ðŸ“Œ ä»¥ä¸‹ä»»åŠ¡ä¾èµ–å½“å‰ä»»åŠ¡ï¼š"
      echo "$dependent_tasks" | while read task_file; do
        task_name=$(grep "^åç§°:" "$task_file" | sed 's/^åç§°: *//')
        task_id=$(basename "$task_file" .md)
        echo "  - $task_name (ID: $task_id)"
      done
      echo ""
      echo "ðŸ” éœ€è¦éªŒè¯æ”¹åŠ¨æ˜¯å¦å½±å“è¿™äº›ä»»åŠ¡çš„å‰ææ¡ä»¶"
    fi
  fi
}
```

#### æŽ¥å£å˜æ›´å½±å“
```bash
# æ£€æŸ¥æŽ¥å£å˜æ›´å¯¹å…¶ä»–ç»„ä»¶çš„å½±å“
check_interface_changes() {
  echo "ðŸ”Œ æ£€æŸ¥æŽ¥å£å˜æ›´å½±å“..."
  
  # æ£€æŸ¥æ˜¯å¦æœ‰APIæˆ–å‡½æ•°ç­¾åå˜æ›´
  if git diff HEAD~1..HEAD | grep -E "function|def|export|interface|type"; then
    echo "âš ï¸ æ£€æµ‹åˆ°å¯èƒ½çš„æŽ¥å£å˜æ›´"
    echo "ðŸ“‹ éœ€è¦æ£€æŸ¥çš„å½±å“èŒƒå›´ï¼š"
    echo "  - è°ƒç”¨æ–¹æ˜¯å¦éœ€è¦æ›´æ–°"
    echo "  - æ˜¯å¦éœ€è¦ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†"
    echo "  - æ–‡æ¡£æ˜¯å¦éœ€è¦æ›´æ–°"
  fi
}
```

### 7. æ”¹è¿›å»ºè®®ç”Ÿæˆ

#### ä½¿ç”¨æ–‡ä»¶åˆ†æžæ™ºèƒ½ä½“æ€»ç»“
```yaml
Task:
  description: "ç”Ÿæˆæ”¹è¿›å»ºè®®"
  subagent_type: "file-analyzer"
  prompt: |
    åŸºäºŽåæ€åˆ†æžç»“æžœï¼Œç”Ÿæˆæ”¹è¿›å»ºè®®ï¼š
    
    åˆ†æžè¾“å…¥ï¼š
    - ä»£ç è´¨é‡è¯„ä¼°ç»“æžœ
    - æž¶æž„ä¸€è‡´æ€§æ£€æŸ¥ç»“æžœ
    - æŠ€æœ¯å€ºåŠ¡è¯†åˆ«ç»“æžœ
    - æ€§èƒ½å½±å“åˆ†æžç»“æžœ
    - ä»»åŠ¡ä¾èµ–åˆ†æžç»“æžœ
    
    è¯·æä¾›ï¼š
    1. ç«‹å³éœ€è¦è§£å†³çš„é—®é¢˜ï¼ˆä¼˜å…ˆçº§é«˜ï¼‰
    2. çŸ­æœŸæ”¹è¿›å»ºè®®ï¼ˆæœ¬å‘¨å†…ï¼‰
    3. é•¿æœŸä¼˜åŒ–æ–¹å‘ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰
    4. é£Žé™©ç¼“è§£æŽªæ–½
    5. ç›‘æŽ§å’ŒéªŒè¯å»ºè®®
    
    å»ºè®®è¦å…·ä½“å¯æ“ä½œï¼ŒæŒ‰ä¼˜å…ˆçº§æŽ’åºã€‚
```

## è¾“å‡ºæ ¼å¼

### æ ‡å‡†åæ€æŠ¥å‘Š
```markdown
ðŸ¤” æ”¹åŠ¨åæ€åˆ†æžæŠ¥å‘Š

## ðŸ“Š æ”¹åŠ¨æ¦‚è§ˆ
- åˆ†æžæ—¶é—´ï¼š{å½“å‰æ—¶é—´}
- æ”¹åŠ¨èŒƒå›´ï¼š{ä¿®æ”¹æ–‡ä»¶æ•°é‡} ä¸ªæ–‡ä»¶
- å½“å‰ä»»åŠ¡ï¼š{ä»»åŠ¡åç§°}ï¼ˆID: {ä»»åŠ¡ID}ï¼‰
- GitçŠ¶æ€ï¼š{clean/æœ‰æœªæäº¤å˜æ›´}

## ðŸŽ¯ ä»»åŠ¡å¯¹é½åº¦è¯„ä¼°
### éªŒæ”¶æ ‡å‡†å®Œæˆæƒ…å†µ
- âœ… æ ‡å‡†1ï¼š{å…·ä½“æ ‡å‡†} - å·²æ»¡è¶³
- âš ï¸ æ ‡å‡†2ï¼š{å…·ä½“æ ‡å‡†} - éƒ¨åˆ†æ»¡è¶³
- âŒ æ ‡å‡†3ï¼š{å…·ä½“æ ‡å‡†} - æœªæ»¡è¶³

### é¢„æœŸvså®žé™…
- **é¢„æœŸæ–¹æ¡ˆ**ï¼š{ç®€è¦æè¿°}
- **å®žé™…å®žçŽ°**ï¼š{ç®€è¦æè¿°}
- **å·®å¼‚åˆ†æž**ï¼š{å·®å¼‚è¯´æ˜Ž}

## ðŸ—ï¸ æž¶æž„ä¸€è‡´æ€§
- **æ¨¡å¼éµå¾ª**ï¼š{éµå¾ª/è¿å} æ—¢å®šæž¶æž„æ¨¡å¼
- **ç»“æž„ä¸€è‡´**ï¼š{ç›®å½•å’Œå‘½åæ˜¯å¦ä¸€è‡´}
- **è¾¹ç•Œæ¸…æ™°**ï¼š{ç»„ä»¶è¾¹ç•Œæ˜¯å¦æ¸…æ™°}
- **æ–‡æ¡£åŒæ­¥**ï¼š{æž¶æž„æ–‡æ¡£æ˜¯å¦éœ€è¦æ›´æ–°}

## ðŸ’³ æŠ€æœ¯å€ºåŠ¡è¯„ä¼°
- **å€ºåŠ¡ç­‰çº§**ï¼š{æ— /ä½Ž/ä¸­/é«˜}
- **ä¸»è¦é—®é¢˜**ï¼š
  - {é—®é¢˜1}
  - {é—®é¢˜2}
- **å½±å“è¯„ä¼°**ï¼š{å¯¹ç»´æŠ¤æ€§çš„å½±å“}

## âš¡ æ€§èƒ½å½±å“
- **æ€§èƒ½å½±å“**ï¼š{ç§¯æž/ä¸­æ€§/è´Ÿé¢}
- **å…³æ³¨ç‚¹**ï¼š
  - {æ€§èƒ½å…³æ³¨ç‚¹1}
  - {æ€§èƒ½å…³æ³¨ç‚¹2}
- **å»ºè®®ç›‘æŽ§**ï¼š{éœ€è¦ç›‘æŽ§çš„æŒ‡æ ‡}

## ðŸ“ˆ åŽç»­ä»»åŠ¡å½±å“
- **ä¾èµ–ä»»åŠ¡æ•°é‡**ï¼š{æ•°é‡}
- **å½±å“ç±»åž‹**ï¼š{æ­£é¢/è´Ÿé¢/ä¸­æ€§}
- **éœ€è¦è°ƒæ•´çš„ä»»åŠ¡**ï¼š
  - {ä»»åŠ¡1}ï¼š{è°ƒæ•´åŽŸå› }
  - {ä»»åŠ¡2}ï¼š{è°ƒæ•´åŽŸå› }

## ðŸ“‹ æ”¹è¿›å»ºè®®
### ðŸ”´ ç«‹å³å¤„ç†ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
1. {å…·ä½“å»ºè®®}
2. {å…·ä½“å»ºè®®}

### ðŸŸ¡ çŸ­æœŸæ”¹è¿›ï¼ˆæœ¬å‘¨å†…ï¼‰
1. {å…·ä½“å»ºè®®}
2. {å…·ä½“å»ºè®®}

### ðŸŸ¢ é•¿æœŸä¼˜åŒ–ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰
1. {å…·ä½“å»ºè®®}
2. {å…·ä½“å»ºè®®}

## ðŸŽ–ï¸ æ€»ä½“è¯„åˆ†
- **ä»£ç è´¨é‡**ï¼š{åˆ†æ•°}/10
- **æž¶æž„ä¸€è‡´æ€§**ï¼š{åˆ†æ•°}/10
- **ä»»åŠ¡å®Œæˆåº¦**ï¼š{åˆ†æ•°}/10
- **ç»¼åˆè¯„åˆ†**ï¼š{åˆ†æ•°}/10

## ðŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. {å…·ä½“è¡ŒåŠ¨é¡¹1}
2. {å…·ä½“è¡ŒåŠ¨é¡¹2}
3. {å…·ä½“è¡ŒåŠ¨é¡¹3}
```

### ç®€æ´ç‰ˆæŠ¥å‘Š
```markdown
ðŸ¤” å¿«é€Ÿåæ€æ‘˜è¦

âœ… **åšå¾—å¥½çš„**ï¼š
- {äº®ç‚¹1}
- {äº®ç‚¹2}

âš ï¸ **éœ€è¦å…³æ³¨**ï¼š
- {å…³æ³¨ç‚¹1}
- {å…³æ³¨ç‚¹2}

ðŸ”§ **ç«‹å³è¡ŒåŠ¨**ï¼š
- {è¡ŒåŠ¨é¡¹1}
- {è¡ŒåŠ¨é¡¹2}

ðŸ“Š **æ€»ä½“è¯„åˆ†**ï¼š{åˆ†æ•°}/10 - {è¯„çº§}
```

## è‡ªåŠ¨è§¦å‘æœºåˆ¶

### ä»»åŠ¡å®ŒæˆåŽè‡ªåŠ¨åæ€
```bash
# é›†æˆåˆ°task-start.mdçš„å®Œæˆæµç¨‹ä¸­
auto_reflect_on_task_completion() {
  echo "ðŸ¤” ä»»åŠ¡å®Œæˆï¼Œè‡ªåŠ¨å¼€å§‹åæ€åˆ†æž..."
  /dd:reflect-on-changes
  
  # å°†åæ€ç»“æžœé™„åŠ åˆ°ä»»åŠ¡è®°å½•
  cat >> .claude/context/current-task.md << EOF

## å®Œæˆåæ€
$(cat /tmp/reflection-summary.md)
EOF
}
```

### é‡è¦å˜æ›´æ£€æµ‹è§¦å‘
```bash
# å½“æ£€æµ‹åˆ°é‡è¦å˜æ›´æ—¶è‡ªåŠ¨è§¦å‘
check_significant_changes() {
  local changed_files=$(git diff --name-only HEAD~1..HEAD | wc -l)
  local changed_lines=$(git diff --stat HEAD~1..HEAD | tail -1 | grep -o '[0-9]\+ insertions\|[0-9]\+ deletions' | awk '{sum += $1} END {print sum}')
  
  if [ "$changed_files" -gt 5 ] || [ "$changed_lines" -gt 100 ]; then
    echo "ðŸš¨ æ£€æµ‹åˆ°é‡è¦å˜æ›´ï¼Œå»ºè®®è¿›è¡Œåæ€åˆ†æž"
    echo "ðŸ’¡ è¿è¡Œï¼š/dd:reflect-on-changes --è¯¦ç»†"
  fi
}
```

## æŒç»­æ”¹è¿›

### åæ€åŽ†å²è·Ÿè¸ª
```bash
# ä¿å­˜åæ€åŽ†å²ï¼Œç”¨äºŽæ¨¡å¼è¯†åˆ«
save_reflection_history() {
  local current_time=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
  local reflection_file=".claude/context/reflection-history.md"
  
  if [ ! -f "$reflection_file" ]; then
    echo "# åæ€åŽ†å²è®°å½•" > "$reflection_file"
  fi
  
  cat >> "$reflection_file" << EOF

## åæ€è®°å½• - $current_time
ä»»åŠ¡ï¼š{å½“å‰ä»»åŠ¡}
è¯„åˆ†ï¼š{æ€»ä½“è¯„åˆ†}
ä¸»è¦é—®é¢˜ï¼š{ä¸»è¦é—®é¢˜æ‘˜è¦}
æ”¹è¿›å»ºè®®ï¼š{ä¸»è¦å»ºè®®}

EOF
}
```

### æ¨¡å¼å­¦ä¹ 
```bash
# åˆ†æžåæ€åŽ†å²ï¼Œè¯†åˆ«æ”¹è¿›æ¨¡å¼
analyze_improvement_patterns() {
  if [ -f ".claude/context/reflection-history.md" ]; then
    echo "ðŸ“ˆ åˆ†æžæ”¹è¿›æ¨¡å¼..."
    
    # ç»Ÿè®¡å¸¸è§é—®é¢˜
    common_issues=$(grep "ä¸»è¦é—®é¢˜ï¼š" .claude/context/reflection-history.md | sort | uniq -c | sort -nr)
    
    echo "ðŸ” å¸¸è§é—®é¢˜æŽ’åºï¼š"
    echo "$common_issues"
  fi
}
```

## æœ€ä½³å®žè·µ

### åæ€æ—¶æœº
1. **ä»»åŠ¡å®ŒæˆåŽ** - éªŒè¯ä»»åŠ¡ç›®æ ‡è¾¾æˆ
2. **é‡è¦å˜æ›´åŽ** - è¯„ä¼°å˜æ›´å½±å“
3. **é˜¶æ®µæ€§é‡Œç¨‹ç¢‘** - æ€»ç»“é˜¶æ®µæ€§è¿›å±•
4. **é‡åˆ°é—®é¢˜æ—¶** - åˆ†æžé—®é¢˜æ ¹å› 

### åæ€è´¨é‡
1. **å®¢è§‚æ€§** - åŸºäºŽäº‹å®žå’Œæ•°æ®
2. **å…·ä½“æ€§** - æä¾›å…·ä½“çš„æ”¹è¿›å»ºè®®
3. **å‰çž»æ€§** - è€ƒè™‘å¯¹æœªæ¥çš„å½±å“
4. **è¡ŒåŠ¨æ€§** - æ¯ä¸ªå»ºè®®éƒ½å¯æ“ä½œ