---
allowed-tools: Task, Read, Write, Edit, Bash
---

# Feature Refactory

基于用户需求对已有功能进行重构，重新执行功能设计流程。

## Usage

```bash
/dd:feature-refactory <功能名称>
```

## Instructions

### 1. 文档生成规范

所有生成的文档内容必须遵循以下格式规范：

- **中英文混合文本**：英文单词与中文字符之间必须有一个空格
- **示例**：`这是一个 React 组件重构` 而不是 `这是一个React组件重构`
- **适用范围**：所有重构分析、技术方案等文档
- **特殊情况**：标点符号前后不需要额外空格

### 2. 重构需求分析

- 与用户深度交流重构原因和目标
- 分析现有功能的问题和改进点
- 明确重构的范围和边界
- 评估重构的必要性和价值

### 3. 现状评估

- 分析当前功能实现状态
- 评估现有代码和架构问题
- 识别技术债务和性能瓶颈
- 分析用户反馈和使用痛点

### 4. 重构方案设计

- 基于分析结果设计重构方案
- 重新定义功能目标和用户价值
- 调整核心功能点和技术实现
- 制定重构的执行策略

### 5. 重新生成功能文档

- 执行 feature-add.md 的完整流程
- 基于重构上下文重新生成三大文档：
  - overview.md - 重构后的功能描述
  - technical.md - 新的技术实现方案
- 保留历史版本进行对比

### 6. 深度思考维度

- **重构必要性**: 是否真正需要重构，还是小幅优化即可
- **影响范围**: 重构对其他功能和系统的影响评估
- **技术风险**: 重构可能带来的技术风险和挑战
- **资源投入**: 重构所需的时间、人力和技术资源
- **用户价值**: 重构能为用户带来的实际价值提升

### 7. 执行流程

1. **现状分析** - 深度分析当前功能的实现和问题
2. **重构对话** - 与用户进行深度对话，明确重构需求
3. **方案设计** - 基于分析和对话设计重构方案
4. **AI 质疑优化** - AI 主动质疑方案合理性并提出优化建议
5. **重新生成文档** - 执行 feature-add 流程重新生成功能文档
6. **影响评估** - 评估重构对项目整体的影响

### 8. 重构策略

**渐进式重构**

- 分阶段执行重构，降低风险
- 保持功能可用性，避免服务中断
- 逐步迁移用户和数据

**重写式重构**

- 基于新架构完全重新实现
- 适用于架构根本性问题
- 需要完整的迁移计划

**优化式重构**

- 保持现有架构，优化实现细节
- 提升性能和代码质量
- 降低维护成本

### 9. 输出规范

- 重构分析报告
- 更新的完整功能文档集合 (overview.md, technical.md)
- 重构执行计划和风险评估
- 下一步操作建议

## Important Notes

基于深度分析和用户需求，系统性重构已有功能，重新执行完整的功能设计流程。
